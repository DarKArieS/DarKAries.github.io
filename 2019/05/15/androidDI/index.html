<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>å’–å•¡çš„æ•…äº‹ï¼š ä¾è³´æ³¨å…¥ã€Daggerã€Android | è²“åœˆéƒ¨è½</title>
  
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">
  

  

  
  <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-130083931-1', 'http://yoursite.com');
      ga('send', 'pageview');
    </script>
  
  
</head>

<body>
    <div id="loading-bar-wrapper">
  <div id="loading-bar" class="pure"></div>
</div>

    <script>setLoadingBarProgress(20)</script>
    <header class="l_header pure">
	<div class="wrapper">
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href="/">
        
          è²“åœˆéƒ¨è½
        
      </a>
			<div class="menu">
				<ul class="h-list">
          
  					
  						<li>
								<a id="categories" class="nav flat-box" href="/categories/">
									<i class="fas fa-folder-open fa-fw"></i>&nbsp;Categories
								</a>
							</li>
      			
  						<li>
								<a id="tags" class="nav flat-box" href="/tags/">
									<i class="fas fa-hashtag fa-fw"></i>&nbsp;Tags
								</a>
							</li>
      			
  						<li>
								<a id="archives" class="nav flat-box" href="/archives/">
									<i class="fas fa-archive fa-fw"></i>&nbsp;Archives
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="æœå°‹">
						<span class="icon"><i class="fas fa-search fa-fw"></i></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
				<li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu">
      <ul>
          
              
                  <li>
										<a id="categories" class="nav flat-box" href="/categories/">
											<i class="fas fa-folder-open fa-fw"></i>&nbsp;Categories
										</a>
                  </li>
              
                  <li>
										<a id="tags" class="nav flat-box" href="/tags/">
											<i class="fas fa-hashtag fa-fw"></i>&nbsp;Tags
										</a>
                  </li>
              
                  <li>
										<a id="archives" class="nav flat-box" href="/archives/">
											<i class="fas fa-archive fa-fw"></i>&nbsp;Archives
										</a>
                  </li>
              
       
      </ul>
		</nav>
    </header>
	</aside>

    <script>setLoadingBarProgress(40);</script>
    <div class="l_body">
    <div class='container clearfix'>
        <div class='l_main'>
            <article id="post" class="post white-box article-type-post" itemscope="" itemprop="blogPost">
  
<section class="meta">
  
  
  <div class="meta" id="header-meta">
    
      
          <h1 class="title">å’–å•¡çš„æ•…äº‹ï¼š ä¾è³´æ³¨å…¥ã€Daggerã€Android</h1>
      
    

    <div class="new-meta-box">
      
        <div class="new-meta-item author">
          <a href="http://yoursite.com">
            <i class="fas fa-user" aria-hidden="true"></i>
            è²“åœˆåœˆ
          </a>
        </div>
      
      
        <div class="new-meta-item date">
          <a class="notlink">
            <i class="fas fa-calendar-alt" aria-hidden="true"></i>
            2019-05-15
          </a>
        </div>
      
      
        
          
          <div class="new-meta-item category">
            <a href="/categories/Android-Note/">
              <i class="fas fa-folder-open" aria-hidden="true"></i>
              Android Note
            </a>
          </div>
        
      
      
        
          <div class="new-meta-item browse busuanzi">
            <a class="notlink">
              <i class="fas fa-eye" aria-hidden="true"></i>
              <span id="busuanzi_value_page_pv">
                <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
              </span>
            </a>
          </div>
        
      
      
    </div>
    <hr>
  </div>
</section>

    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>æœ€è¿‘é‚„æ˜¯åœ¨é–±è®€ä¸€äº› <a href="https://github.com/googlesamples/android-architecture-components" target="_blank" rel="noopener">Google Android ç¯„ä¾‹</a>ï¼Œæœ‰å€‹å«åš Dagger çš„æ±è¥¿å¸¸å¸¸å‡ºç¾ï¼Œè®“äººä»¥ç‚ºåˆè¦é–‹å§‹ç®—Hermitian $H^{\dagger}$ çŸ©é™£äº†ã€‚<br>
è©²æ¡†æ¶å¼•å…¥äº†ä¸€å †Annotationï¼Œçœ‹å¾—é ­æ˜çœ¼èŠ±ï¼Œ Ctrl+B è¿½äº†åŠå¤©ä»€éº¼å¿ƒå¾—éƒ½æ²’æœ‰(èª¤)</p>
<p>å¥½å•¦ï¼Œäº‚æ‰¯ä¸€é€šã€‚å¤§å®¶éƒ½çŸ¥é“ Dagger åœ¨åšçš„äº‹æƒ…æ˜¯ä¾è³´æ³¨å…¥ (Dependency Injection, DI) ï¼Œé‚£å®ƒåˆ°åº•åœ¨å¹¹å˜›ï¼Ÿæˆ‘å€‘å¹¹å˜›è¦ç”¨å®ƒï¼Ÿ</p>
<p>ç¶²è·¯ä¸Šé—œæ–¼DIçš„æ–‡ç« éš¨ä¾¿æŠ“éƒ½ä¸€å¤§æŠŠï¼Œçœ‹å¾—é ­æ˜çœ¼èŠ±ã€‚<br>
ç‚ºäº†é¿å…è‡ªå·±æ”¾æ£„ï¼Œä¹¾è„†è‡ªå·±ä¾†å¯«ä¸€ç¯‡ï¼Œå¸Œæœ›ä¸æœƒèª¤äººå­å¼Ÿã€‚</p>
<p>ç”±æ–¼å‰›é–‹å§‹ç ”ç©¶ Dagger çš„æ™‚å€™æ˜¯ç›´æ¥å¾ Android å°ˆæ¡ˆä¸­çš„ç¯„ä¾‹é–‹å§‹çš„ï¼Œæ®Šä¸çŸ¥ï¼Œ Dagger ç‚ºäº†è¿åˆ<br>
Android App çš„é‹è¡Œæ–¹å¼è€Œç”¨äº†ä¸€äº›<s>æ—é–€å·¦é“</s>ç‰¹åˆ¥çš„æ–¹å¼ä¾†é”æˆä¾è³´æ³¨å…¥ï¼Œä½¿ä¸Šæ‰‹é›£åº¦åˆå†æå‡ä¸€å€‹æª”æ¬¡ã€‚</p>
<p>æ–¼æ˜¯é€™ç¯‡æ–‡ç« å…ˆä¸å¾ Android App çš„è§’åº¦åˆ‡å…¥ï¼Œæœ‰è«‹ <a href="https://google.github.io/dagger/" target="_blank" rel="noopener">Dagger</a> å®˜æ–¹æä¾›çš„ <a href="https://github.com/google/dagger/tree/master/examples/simple/src/main/java/coffee" target="_blank" rel="noopener">Coffemaker</a> ç¯„ä¾‹ä¾†ç¾èº«èªªæ³•å…ˆã€‚</p>
<p>åœ¨é€™ç¯‡æ–‡ä¸­æœƒä½¿ç”¨ Kotlin èªè¨€ï¼Œ<s>æ¥åœ°æ°£</s>ï¼Œå¯ä»¥åƒè€ƒçœ‹çœ‹ã€‚</p>
<a id="more"></a>
<h1 id="dependency-ä¾è³´çš„æ•…äº‹"><a class="header-anchor" href="#dependency-ä¾è³´çš„æ•…äº‹">Â¶</a>Dependency ä¾è³´çš„æ•…äº‹</h1>
<h2 id="åšä¸€å°å’–å•¡æ©Ÿ"><a class="header-anchor" href="#åšä¸€å°å’–å•¡æ©Ÿ">Â¶</a>åšä¸€å°å’–å•¡æ©Ÿ</h2>
<p>ç¾åœ¨æˆ‘å€‘æœ‰ä¸€å°å’–å•¡æ©Ÿ (CoffeeMaker) ï¼Œçµ„æˆçš„é›¶ä»¶æœ‰å¹«æµ¦ (Pump) ã€åŠ ç†±è¨ˆ (Heater)ã€‚</p>
<p>å’–å•¡çš„è£½ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åŠ ç†±å™¨æ‰“é–‹ (Heater on)</li>
<li>å¹«æµ¦æ‰“æ°´ç…®å’–å•¡ (Pumping)</li>
<li>å’–å•¡ç…®å¥½äº†ï¼</li>
<li>åŠ ç†±å™¨é—œæ‰ (Heater off)</li>
</ul>
<div id="flowchart-0" class="flow-chart"></div>
<p>é¦–å…ˆï¼ŒåŠ ç†±å™¨é•·é€™å€‹æ¨£å­ï¼Œæˆ‘å€‘é¸ç”¨äº†é›»å­åŠ ç†±å™¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ElectricHeater</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> heating = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isHot</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heating</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">off</span><span class="params">()</span></span> &#123;</span><br><span class="line">        heating = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">on</span><span class="params">()</span></span> &#123;</span><br><span class="line">        println(<span class="string">"~ ~ ~ heating ~ ~ ~"</span>)</span><br><span class="line">        heating = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥è‘—ç™»å ´çš„æ˜¯å¹«æµ¦ï¼Œæ˜¯å€‹è™¹å¸è£ç½®ã€‚<br>
é€™å€‹è£ç½®æœ‰é˜²å‘†åŠŸèƒ½ï¼Œé˜²æ­¢é˜¿å‘†å¿˜è¨˜åŠ ç†±å°±æ‰“æ°´ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span></span>(<span class="keyword">val</span> heater: ElectricHeater)&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">pump</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(heater.isHot())&#123;</span><br><span class="line">            println(<span class="string">"=&gt; =&gt; pumping =&gt; =&gt;"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ–¼æ˜¯æˆ‘å€‘çš„å’–å•¡æ©Ÿé•·é€™å€‹æ¨£å­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffeemaker</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> heater = ElectricHeater()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> pump = Thermosiphon(heater)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">brew</span><span class="params">()</span></span>&#123;</span><br><span class="line">        heater.on()</span><br><span class="line">        pump.pump()</span><br><span class="line">        println(<span class="string">" [_]P coffee! [_]P "</span>)</span><br><span class="line">        heater.off()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾ˆå¥½ï¼Œçœ‹èµ·ä¾†æ²’ä»€éº¼å•é¡Œï¼Œæ•…äº‹çµæŸäº†ã€‚</p>
<p>æ‰ä¸ã€‚</p>
<h2 id="ä¾è³´é—œä¿‚"><a class="header-anchor" href="#ä¾è³´é—œä¿‚">Â¶</a>ä¾è³´é—œä¿‚</h2>
<p>è®“æˆ‘å€‘ä¾†åˆ†æä¸€ä¸‹å„å€‹é›¶ä»¶ä¹‹é–“çš„é—œä¿‚ã€‚</p>
<!-- 
<div id="flowchart-1" class="flow-chart"></div>
-->
<img src="https://i.imgur.com/MUoGB04.png" width="80%">
<p>å’–å•¡æ©Ÿä¾è³´äº†å¹«æµ¦è·ŸåŠ ç†±å™¨ï¼Œè€Œå¹«æµ¦åˆä¾è³´æ–¼åŠ ç†±å™¨ã€‚åŠ ç†±å™¨æ²’æœ‰å¹«æµ¦è·Ÿå’–å•¡æ©Ÿä¹Ÿå¯ä»¥é‹ä½œï¼Œä½†å’–å•¡æ©Ÿå’Œå¹«æµ¦å‰‡ä¸èƒ½æ²’æœ‰åŠ ç†±å™¨ã€‚</p>
<p>æˆ‘å€‘æœƒèªªï¼Œå’–å•¡æ©Ÿæ˜¯å€‹é«˜å±¤æ¨¡çµ„ï¼Œä¾è³´æ–¼ä½å±¤æ¨¡çµ„çš„å¹«æµ¦è·ŸåŠ ç†±å™¨ã€‚</p>
<p>å›éé ­ä¾†çœ‹çœ‹ Coffeemaker é€™å€‹ classã€‚ç•¶æˆ‘å€‘è¦è£½é€  (å¯¦ä¾‹åŒ–ï¼ŒInstantiate) å‡ºä¸€å°å’–å•¡æ©Ÿçš„æ™‚å€™ï¼ŒåŒæ™‚ä¹Ÿæœƒè£½é€ å‡ºæ–°çš„å¹«æµ¦è·ŸåŠ ç†±å™¨ï¼Œå±¬æ–¼ä¸€æ¢é¾æœå‹™ã€‚</p>
<p>é€™æ¨£æœƒæœ‰ä»€éº¼å•é¡Œå‘¢?</p>
<ul>
<li>
<p>ç‹€æ³ä¸€ï¼šæŸå€‹æ”¶é›†å’–å•¡æ©Ÿçš„æ„›å¥½è€…æƒ³è¦æ“æœ‰å¾ˆå¤šå°å’–å•¡æ©Ÿï¼Œä½†æ˜¯ä¸æƒ³è¦æ“æœ‰å¾ˆå¤šçš„å¹«æµ¦è·Ÿç†±å™¨ã€‚ä½†æ˜¯æ¯ä¸€å°å’–å•¡æ©Ÿéƒ½è‡ªå¸¶å¹«æµ¦è·ŸåŠ ç†±å™¨ï¼Œæµªè²»è³‡æºã€‚</p>
</li>
<li>
<p>ç‹€æ³äºŒï¼šå» å•†åœ¨ç ”ç™¼å’–å•¡æ©Ÿçš„æ™‚å€™ï¼Œæƒ³è¦æ‹¿å€‹å‡çš„åŠ ç†±å™¨è·Ÿå¹«æµ¦ä¾†è©¦è©¦çœ‹å’–å•¡è£½ä½œæµç¨‹æœ‰æ²’æœ‰éŒ¯èª¤ã€‚åœ¨ä¸€æ¢é¾æœå‹™ä¸‹æ²’è¾¦æ³•åœ¨ä¸å‹• Coffeemaker é…æ–¹ (ç¨‹å¼ç¢¼) çš„æƒ…æ³ä¸‹å®Œæˆã€‚</p>
</li>
<li>
<p>ç‹€æ³ä¸‰ï¼šæœ‰ä¸€å¤©ï¼ŒåŠ ç†±å™¨å¤§æ”¹ç‰ˆï¼ŒæŠŠonæ–¹æ³•æ”¹æˆäº†openï¼Œå’–å•¡æ©Ÿå¿…é ˆè¦é…åˆåŠ ç†±å™¨è·Ÿè‘—æ”¹ç‰ˆæ‰èƒ½é †åˆ©é‹ä½œã€‚</p>
</li>
<li>
<p>ç‹€æ³å››ï¼šæœ‰ä¸€å¤©ï¼Œæ­ç›Ÿå¿ƒè¡€ä¾†æ½®ï¼Œç«¯è‘—åå£Ÿæ–·æ³•ä¾†æŸ¥æ°´è¡¨ï¼Œå› ç‚ºä½ çš„æ©Ÿå™¨åªæ¥å—é›»å­åŠ ç†±å™¨ã€‚</p>
</li>
</ul>
<p>â€¦</p>
<p>å¾è»Ÿé«”å·¥ç¨‹çš„è§’åº¦ä¾†çœ‹ï¼Œæˆ‘å€‘æœƒèªªé€™äº›çµ„ä»¶æœ‰è‘—é«˜<a href="https://en.wikipedia.org/wiki/Coupling_(computer_programming)" target="_blank" rel="noopener">ç›¸ä¾æ€§</a> (High dependency, high coupling) ï¼Œç‰½ä¸€é«®è€Œå‹•å…¨èº«ï¼Œè€Œä¸”ç‰©ä»¶ç„¡æ³•è¢«é‡ç”¨ (Reuse) ã€‚</p>
<p>å¥½ï¼Œé‚£æˆ‘å€‘ä¾†æ”¹å€‹è¨­è¨ˆï¼Œè§£æ±ºé€™äº›å•é¡Œã€‚</p>
<h2 id="è§£é–‹ä¾è³´-decouple-ä¾è³´æ³¨å…¥"><a class="header-anchor" href="#è§£é–‹ä¾è³´-decouple-ä¾è³´æ³¨å…¥">Â¶</a>è§£é–‹ä¾è³´ (Decouple) - ä¾è³´æ³¨å…¥</h2>
<p>é¦–å…ˆè§£æ±ºç‹€æ³ä¸€ï¼Œåªè¦èª¿æ•´ä¸€ä¸‹ç”¢ç·šå°±å¯ä»¥äº†ã€‚</p>
<p>æˆ‘å€‘å°‡å¹«æµ¦è·ŸåŠ ç†±å™¨å§”å¤–ç”Ÿç”¢ï¼ŒåŒæ™‚å°‡å’–å•¡æ©Ÿæ¨¡çµ„åŒ–ã€‚</p>
<p>ç¾åœ¨æˆ‘å€‘çš„é…æ–¹è®Šæˆé€™æ¨£ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffeemaker</span></span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> heater: ElectricHeater, </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> pump: Thermosiphon</span><br><span class="line">)&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">brew</span><span class="params">()</span></span>&#123;</span><br><span class="line">        heater.on()</span><br><span class="line">        pump.pump()</span><br><span class="line">        println(<span class="string">" [_]P coffee! [_]P "</span>)</span><br><span class="line">        heater.off()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾ˆå¥½ï¼Œç¾åœ¨å’–å•¡æ©Ÿæ”¶é›†ç‹‚å¯ä»¥åªæ“æœ‰ä¸€çµ„åŠ ç†±å™¨è·Ÿå¹«æµ¦ï¼Œä½†æ“æœ‰å¾ˆå¤šå°å’–å•¡æ©Ÿäº†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TheManHavingManyCoffeemakers</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> heater = ElectricHeater()</span><br><span class="line">    <span class="keyword">val</span> pump = Thermosiphon(heater)</span><br><span class="line">    <span class="keyword">val</span> cofeemaker1 = Coffeemaker(heater,pump)</span><br><span class="line">    <span class="keyword">val</span> cofeemaker2 = Coffeemaker(heater,pump)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ æœ‰æ²’æœ‰ç™¼ç¾ï¼Œå…¶å¯¦å¹«æµ¦è·ŸåŠ ç†±å™¨å½¼æ­¤ä¹‹é–“æ—©å°±æ˜¯é€™ç¨®é—œä¿‚å•¦ï¼å¦‚æœå¹«æµ¦è·ŸåŠ ç†±å™¨çµ„åˆæ˜¯ä¸€æ¢é¾æœå‹™çš„è©±ï¼Œæˆ‘å€‘çš„å’–å•¡æ©Ÿå°±åšä¸å‡ºä¾†äº†å‘¢ã€‚</p>
<p>å¦‚æœæœ‰ä¸€å¤©æœ‰å€‹è²ªå¿ƒçš„å‚¢ä¼™æƒ³åšå€‹æœ‰å’–å•¡æ©ŸåŠŸèƒ½çš„å¤§æ©Ÿå™¨ä¹Ÿè¾¦çš„åˆ°äº†ã€‚</p>
<h2 id="ä¾è³´åè½‰"><a class="header-anchor" href="#ä¾è³´åè½‰">Â¶</a>ä¾è³´åè½‰</h2>
<p>ç„¶å¾Œä¾†è§£æ±ºå•é¡ŒäºŒä¸‰å››ã€‚</p>
<p>ç”Ÿç”¢å’–å•¡æ©Ÿçš„å» å•†æƒ³äº†æƒ³ï¼Œæ±ºå®šè¨‚å€‹æ¨™æº–è¦å‰‡ (interface) ï¼Œè¦å®šåŠ ç†±å™¨è·Ÿå¹«æµ¦çš„è¦æ ¼ï¼Œæ¯”å¦‚èªªå¿…é ˆè¦æœ‰å“ªäº›åŠŸèƒ½ç­‰ç­‰ã€‚å…·é«”å¦‚ä½•å¯¦ç¾é€™å€‹åŠŸèƒ½å‰‡ä¸åœ¨æ¨™æº–ä¹‹å…§ã€‚<br>
æ–¼æ˜¯ï¼Œå’–å•¡æ©Ÿä»¥åŠå…¶ä»–çµ„ä»¶éƒ½å¿…é ˆæŒ‰ç…§é€™å€‹æ¨™æº–ä¾†è¨­è¨ˆã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Heater</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">on</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">off</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isHot</span><span class="params">()</span></span>:<span class="built_in">Boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Pump</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">pump</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å’–å•¡æ©Ÿé…æ–¹è®Šæˆé€™å€‹æ¨£å­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffeemaker</span></span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> heater: Heater, </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> pump: Pump</span><br><span class="line">)&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">brew</span><span class="params">()</span></span>&#123;</span><br><span class="line">        heater.on()</span><br><span class="line">        pump.pump()</span><br><span class="line">        println(<span class="string">" [_]P coffee! [_]P "</span>)</span><br><span class="line">        heater.off()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨é€™è£¡ï¼Œæ‰€æœ‰çš„é›¶ä»¶å¾å¤–éƒ¨å‚³å…¥ã€‚<br>
æˆ‘å€‘ä¹Ÿå¯ä»¥è¨­è¨ˆæˆé€éæ¥å£ (setter) ä¾†ç²å¾—é›¶ä»¶ï¼Œé€™è£¡å°±ä¸æŠŠç¨‹å¼ç¢¼ç§€å‡ºä¾†äº†ã€‚</p>
<p>è®“æˆ‘å€‘ä¾†çœ‹çœ‹é€™æ¨£å¦‚ä½•è§£æ±ºå•é¡Œã€‚</p>
<p>ç¾åœ¨æœ‰äº†é€™ä»½æ¨™æº–ï¼Œåœ¨æ¸¬è©¦çš„æ™‚å€™åªè¦æ ¹æ“šæ¨™æº–è£½ä½œå‡çš„åŠ ç†±å™¨è·Ÿå¹«æµ¦ï¼Œä¾¿å¯ä»¥åœ¨ä¸æ›´å‹• Coffemaker çš„æƒ…å½¢ä¸‹å®Œæˆã€‚</p>
<p>ä¸¦ä¸”ï¼Œä»»ä½•å» å•†éƒ½å¯ä»¥ç”Ÿç”¢å¹«æµ¦è·ŸåŠ ç†±å™¨ï¼Œä¸¦å°‡å®ƒç”¨åœ¨å’–å•¡æ©Ÿä¹‹ä¸­ï¼Œä¸éœ€è¦åŸ·è‘—æ–¼é›»å­åŠ ç†±å™¨ã€‚è¦æ›æˆ<br>
MagicHeater ä¹Ÿä¸æˆå•é¡Œã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicHeater</span> : <span class="type">Heater &#123;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> heating = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">isHot</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> heating</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">off</span><span class="params">()</span></span> &#123;</span><br><span class="line">        heating = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">on</span><span class="params">()</span></span> &#123;</span><br><span class="line">        println(<span class="string">"~ ~ ~ This is Magic ~ ~ ~"</span>)</span><br><span class="line">        println(<span class="string">"~ ~ ~ heating ~ ~ ~"</span>)</span><br><span class="line">        println(<span class="string">"~ ~ ~ magic ~ ~ ~"</span>)</span><br><span class="line">        heating = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œè‡³æ–¼å°‡ on æ”¹æˆ open é€™ç¨®æ”¹ç‰ˆï¼Œç”±æ–¼ä¸ç¬¦åˆè¦å‰‡ï¼Œè©²å» å•†å°‡æœƒè¢«æ¥­ç•Œæ·˜æ±°ã€‚</p>
<p>çœ‹èµ·ä¾†çœŸä¸éŒ¯ï¼</p>
<p>åŸæœ¬çš„ç‹€æ³æ˜¯ï¼Œå’–å•¡æ©Ÿå¿…é ˆè¦é…åˆä½å±¤æ¨¡çµ„ä¾†è¨­è¨ˆã€‚<br>
ç¾åœ¨çš„ç‹€æ³å‰‡æ˜¯é«˜å±¤æ¨¡çµ„ä»¥åŠä½å±¤æ¨¡çµ„éƒ½å¿…é ˆè¦é…åˆ interface ä¾†è¨­è¨ˆã€‚</p>
<p>åœ¨è»Ÿé«”å·¥ç¨‹ä¸­ï¼Œé€™ç¨®æ–¹å¼è¢«ç¨±ä½œä¾è³´åè½‰ã€ç›¸ä¾æ€§åè½‰ã€æ§åˆ¶åè½‰ â€¦ ç­‰ç­‰ã€‚</p>
<h2 id="é™ä½æˆæœ¬-æé«˜å®‰å…¨-èª¤"><a class="header-anchor" href="#é™ä½æˆæœ¬-æé«˜å®‰å…¨-èª¤">Â¶</a>é™ä½æˆæœ¬ã€æé«˜å®‰å…¨ (èª¤)</h2>
<p><s>(æ¨™é¡Œè¦ä¸‹ä»€éº¼æ‰å¥½å‘€)</s></p>
<p>ç¾åœ¨è¦è£½é€ å’–å•¡æ©Ÿï¼Œæˆ‘å€‘æœ€å°‘è¦æ“æœ‰ä¸‰æ¢ä¾›æ‡‰éˆï¼šç”Ÿç”¢å’–å•¡æ©Ÿã€ç”Ÿç”¢å¹«æµ¦ã€ç”Ÿç”¢åŠ ç†±å™¨ã€‚<br>
ä¹Ÿå°±æ˜¯èªªï¼Œæ¯ç•¶åœ¨ä¸åŒçš„åœ°æ–¹è¦ç”Ÿå‡ºä¸€å°å’–å•¡æ©Ÿæ™‚ï¼Œæˆ‘å€‘ä¹Ÿå¿…é ˆç”Ÿå‡ºè‡³å°‘ä¸€çµ„åŠ ç†±å™¨è·Ÿå¹«æµ¦ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeopleInTainan</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> heater = ElectricHeater()</span><br><span class="line">    <span class="keyword">val</span> pump = Thermosiphon(heater)</span><br><span class="line">    <span class="keyword">val</span> cofeemaker = Coffeemaker(heater,pump)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeopleInTaipei</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> heater = ElectricHeater()</span><br><span class="line">    <span class="keyword">val</span> pump = Thermosiphon(heater)</span><br><span class="line">    <span class="keyword">val</span> cofeemaker = Coffeemaker(heater,pump)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>å¥½éº»ç…©å•Šï¼Œä¸€ç›´å¯«é‡è¤‡çš„ code ç¨±ä¸ä¸Šæ˜¯å€‹å¥½çš„å·¥ç¨‹å¸«ã€‚<br>
è€Œä¸”å¯«åœ¨å»ºæ§‹å­è®“ Coffemaker çœ‹èµ·ä¾†å¾ˆè¤‡é›œï¼Œæœ‰æ²’æœ‰ä»€éº¼æ›´ç°¡æ½”çš„æ–¹æ³•ï¼Ÿ</p>
<p>æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¹«æµ¦è·ŸåŠ ç†±å™¨æš´éœ²åœ¨å¤–é ­ï¼Œä½¿ç”¨è€…å¯ä»¥éš¨æ™‚å–å¾—å®ƒå€‘ï¼Œå¯ä»¥æ‹¿å»åšå¥‡æ€ªçš„äº‹ï¼Œä¾‹å¦‚æ‹¿å»ç…®æ³¡éºµã€ç‡™ä»–è¨å­çš„äººã€‚<br>
<s>(åŸºå¾·ï¼šå» å•†æ²’æœ‰è·Ÿä½ èªªå¾®æ³¢çˆä¸èƒ½æ‹¿ä¾†çƒ˜ä¹¾è²“å’ª)</s></p>
<p>æˆ‘å€‘å¼•å…¥ä¸€è‡ºå°ˆé–€çš„æ©Ÿå™¨ (Injector/Container/â€¦) ï¼Œé€™è‡ºæ©Ÿå™¨è² è²¬å°‡å’–å•¡æ©Ÿéœ€è¦çš„åŠ ç†±å™¨ä»¥åŠå¹«æµ¦ç”Ÿå‡ºä¾†ä¸¦å®‰è£åˆ°ä½ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Injector</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> heater = ElectricHeater()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> pump = Thermosiphon(heater)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">provideHeater</span><span class="params">()</span></span> : Heater&#123;</span><br><span class="line">        <span class="keyword">return</span> heater</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">providePump</span><span class="params">()</span></span> : Pump&#123;</span><br><span class="line">        <span class="keyword">return</span> pump</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffeemaker</span></span>(injector:Injector)</span><br><span class="line">&#123;    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> heater = injector.provideHeater()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> pump = injector.providePump()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">brew</span><span class="params">()</span></span>&#123;</span><br><span class="line">        heater.on()</span><br><span class="line">        pump.pump()</span><br><span class="line">        println(<span class="string">" [_]P coffee! [_]P "</span>)</span><br><span class="line">        heater.off()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç•¶å’–å•¡æ©Ÿçš„ä¾è³´é›¶ä»¶éœ€è¦æ›´æ›æˆå…¶ä»–å» å•†çš„é›¶ä»¶æˆ–è€…æ˜¯æ¸¬è©¦ç”¨çš„å½é›¶ä»¶æ™‚ï¼Œåªè¦ä¿®æ”¹æˆ–æ›æ‰é€™è‡ºæ©Ÿå™¨å°±å¯ä»¥äº†ã€‚</p>
<p>æœ‰éœ€è¦çš„è©±ï¼Œä¹Ÿå¯ä»¥ç‚ºé€™å°æ©Ÿå™¨å®šå€‹è¦å‰‡ (interface)ã€‚</p>
<p>æ›´é€²ä¸€æ­¥ï¼Œé‚„å¯ä»¥æŠŠæ•´å€‹è£½ä½œæµç¨‹æ‰“åŒ…èµ·ä¾†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CoffeeMakerProvider</span></span>&#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">provideCoffeeMaker</span><span class="params">()</span></span> = Coffeemaker(Injector())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€™æ¨£ä¸€ä¾†ï¼Œéš¨æ™‚éš¨åœ°éƒ½å¯ä»¥å–å¾—ä¸€è‡ºå…¨æ–°çš„å’–å•¡æ©Ÿï¼è€Œä¸”å…§éƒ¨çµ„ä»¶ä¹Ÿéƒ½è¢«åŒ…è£èµ·ä¾†ä¸éš¨ä¾¿çµ¦äººç”¨äº†ã€‚</p>
<p>è€Œé€™äº›ç”Ÿæˆå¯¦é«”ç”¨çš„ç‰©ä»¶ï¼Œé‚„èƒ½è¦–éœ€æ±‚æ­é…å–®ä¾‹æ¨¡å¼ä¾†ä½¿ç”¨ï¼Œä½¿å¾—æ¯æ¬¡æä¾›çš„åŠ ç†±å™¨ã€å¹«æµ¦æˆ–æ˜¯ Injector éƒ½æ˜¯åŒä¸€å€‹ï¼Œé”åˆ°é‡ç”¨ã€ç¯€çœé‹ç®—è³‡æºã€‚</p>
<p>è¨»ï¼š åœ¨é€™ä¸€ç« ä¸­ï¼Œ pump èˆ‡ heater ä¸¦æ²’æœ‰è¢«è§£è€¦ï¼Œè€Œæ˜¯ä¸€æ•´çµ„ç›´æ¥åŒ…é€²Injectorä¸­ã€‚éœ€è¦çš„è©±æˆ‘å€‘å¯ä»¥å¦‚æ³•ç‚®è£½å°‡ pump èˆ‡ heater åˆ†é–‹ï¼Œç¨‹å¼æœƒè®Šå¾—éå¸¸çš„é•·ã€‚</p>
<h1 id="dagger-ä¾è³´æ³¨å…¥æ¡†æ¶"><a class="header-anchor" href="#dagger-ä¾è³´æ³¨å…¥æ¡†æ¶">Â¶</a>Dagger ä¾è³´æ³¨å…¥æ¡†æ¶</h1>
<p>ç‚ºäº†é”åˆ°å¥½æ“´å……å¥½ç¶­è­·å¥½æ¸¬è©¦çš„ç›®çš„ï¼Œæˆ‘å€‘å¤šå¯«äº†å¾ˆå¤šçš„ç¨‹å¼ç¢¼ï¼Œä½†è‡ªå·±å¯«çš„æ±è¥¿ç¸½æ˜¯è‡ªå·±æœ€æ˜ç™½ã€‚</p>
<p>æœ‰ä¸€å¤©ï¼Œä¸€åæ–°çš„å·¥ç¨‹å¸«è¢«è˜é€²ä¾†ï¼Œèº«ç‚ºè€é³¥çš„æˆ‘å€‘å¿…é ˆè²»ç›¡å”‡èˆŒçš„è§£é‡‹ç”Ÿç”¢ç·šå¦‚ä½•é‹ä½œã€‚</p>
<p>æœ‰äº†ä¾è³´æ³¨å…¥æ¡†æ¶ï¼Œæˆ‘å€‘åªè¦æŠŠæ¡†æ¶çš„æ–‡ä»¶ä¸Ÿçµ¦ä»–å°±å¥½äº†ã€‚</p>
<p>ç¾åœ¨ï¼Œä¾†è«‡è«‡ Dagger å§ã€‚</p>
<p>åŸæœ¬çš„ <a href="https://github.com/square/dagger/" target="_blank" rel="noopener">Dagger</a> æ˜¯ç”±squareå…¬å¸æ‰€ç¶­è­·çš„å°ˆæ¡ˆï¼Œå¾Œä¾†è¢« Google æ¥æ‰‹ï¼Œé€²åŒ–æˆ <a href="https://github.com/google/dagger" target="_blank" rel="noopener">Dagger2</a>ã€‚</p>
<p>æˆ‘å€‘é¸ç”¨çš„æ˜¯ Dagger2 ï¼Œé€™å€‹æ¡†æ¶è—‰ç”±è¨»è§£ (annotation)ï¼Œåœ¨ç·¨è­¯çš„æ™‚å€™è‡ªå‹•ç”¢ç”Ÿä»£ç¢¼ä¾†å®Œæˆä¾è³´æ³¨å…¥ã€‚</p>
<p>æŠŠ Dagger2 åŠ å…¥ Gradle ä¸­å§ï¼<br>
åœ¨ä½¿ç”¨Kotlinçš„ç’°å¢ƒä¸­ï¼Œ <a href="https://blog.jetbrains.com/kotlin/2015/06/better-annotation-processing-supporting-stubs-in-kapt/" target="_blank" rel="noopener">Kotlin å®˜æ–¹å»ºè­°æŠŠè¨»è§£è§£é‡‹å™¨ (annotation processor) æ›æˆ kapt</a></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">...</span><br><span class="line">    implementation <span class="string">'com.google.dagger:dagger:2.17'</span></span><br><span class="line">    kapt <span class="string">'com.google.dagger:dagger-compiler:2.17'</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="é‚„æ˜¯å’–å•¡æ©Ÿçš„æ•…äº‹"><a class="header-anchor" href="#é‚„æ˜¯å’–å•¡æ©Ÿçš„æ•…äº‹">Â¶</a>é‚„æ˜¯å’–å•¡æ©Ÿçš„æ•…äº‹</h2>
<h3 id="inject"><a class="header-anchor" href="#inject">Â¶</a>Inject</h3>
<p>é¦–å…ˆï¼Œæˆ‘å€‘æ”¹é€ ä¸€ä¸‹éœ€è¦ä¾è³´æ³¨å…¥çš„å¹«æµ¦ä»¥åŠå’–å•¡æ©Ÿï¼ŒæŠŠéœ€è¦è¢«æ³¨å…¥çš„ç‰©ä»¶ (åŠ ç†±å™¨) ç”¨ <code>@Inject</code> æ¨™è¨˜èµ·ä¾†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span> <span class="meta">@Inject</span> <span class="keyword">constructor</span></span>(<span class="keyword">val</span> heater: Heater) : Pump &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">pump</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(heater.isHot())&#123;</span><br><span class="line">            println(<span class="string">"=&gt; =&gt; pumping =&gt; =&gt;"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CoffeeMaker</span> <span class="meta">@Inject</span> <span class="keyword">constructor</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> heater: Heater, <span class="keyword">private</span> <span class="keyword">val</span> pump: Pump) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">brew</span><span class="params">()</span></span>&#123;</span><br><span class="line">        heater.on()</span><br><span class="line">        pump.pump()</span><br><span class="line">        println(<span class="string">" [_]P coffee! [_]P "</span>)</span><br><span class="line">        heater.off()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨Dagger2ä¸­ï¼Œ <code>@Inject</code> å¯ä»¥ç”¨ä¾†æ¨™è¨˜å»ºæ§‹å­ã€å±¬æ€§ã€ä»¥åŠå‡½å¼ï¼Œé€™è£¡ä»¥æ¨™è¨˜å»ºæ§‹å­ä½œç‚ºç¯„ä¾‹ã€‚</p>
<h3 id="module"><a class="header-anchor" href="#module">Â¶</a>Module</h3>
<p>æ¥ä¸‹ä¾†å»ºç«‹ Module ï¼Œä»–çš„è…³è‰²ç›¸ç•¶æ–¼å‰ä¸€ç«  Injector çš„è…³è‰²ï¼Œè² è²¬ç”¢ç”Ÿé›¶ä»¶å¯¦é«”ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module(includes = [PumpModule::class])</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CoffeeMakerModule</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Provides</span></span><br><span class="line">   <span class="function"><span class="keyword">fun</span> <span class="title">provideHeater</span><span class="params">()</span></span>:Heater&#123;</span><br><span class="line">       <span class="keyword">return</span> ElectricHeater()</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PumpModule</span></span>&#123;</span><br><span class="line">    <span class="meta">@Binds</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">providePump</span><span class="params">(pump: <span class="type">Thermosiphon</span>)</span></span>:Pump</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±æ–¼ <code>Thermosiphon</code> ä¹Ÿä¾è³´æ–¼ <code>Heater</code> ï¼Œå› æ­¤å¹«æµ¦çš„æä¾›æ–¹æ³•ä¸ä½¿ç”¨ <code>@Provides</code> ï¼Œè€Œæ˜¯ç”¨ <code>@Binds</code> å°‡æä¾›å¹«æµ¦çš„æ–¹æ³•ä»¥åŠæˆ‘å€‘é¸æ“‡çš„å¹«æµ¦å¯¦ä½œé¡åˆ¥ (Thermosiphon) é€£çµèµ·ä¾†ã€‚<br>
æœ€å¾Œä½¿ç”¨ <code>includes</code> å°‡å…©å€‹æ¨¡çµ„é€£çµèµ·ä¾†ï¼ŒDaggeræœƒå°‡åŒä¸€å€‹åŠ ç†±å™¨åŒæ™‚æ³¨å…¥åˆ°å’–å•¡æ©Ÿä»¥åŠå¹«æµ¦ä¸­ã€‚</p>
<h3 id="component"><a class="header-anchor" href="#component">Â¶</a>Component</h3>
<p>æœ€å¾Œå‰‡æ˜¯ç”¢ç”Ÿå’–å•¡æ©Ÿçš„ä¸€æ¢é¾ç”¢ç·š Component ï¼Œç›¸ç•¶æ–¼å‰ä¸€ç« çš„ CoffeeMakerProvider ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(modules = [CoffeeMakerModule::class])</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">CoffeeComponent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">provideCoffeeMaker</span><span class="params">()</span></span> : CoffeeMaker</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘å€‘åªè¦å‘Šè¨´ Dagger è¦ä½¿ç”¨çš„æ¨¡çµ„ä»¥åŠè¦ç”¢ç”Ÿçš„å’–å•¡æ©Ÿé¡åˆ¥å°±å¯ä»¥äº†ã€‚</p>
<h3 id="åšå’–å•¡å›‰"><a class="header-anchor" href="#åšå’–å•¡å›‰">Â¶</a>åšå’–å•¡å›‰</h3>
<p>æ±è¥¿éƒ½æº–å‚™å¥½äº†ä¹‹å¾Œï¼Œ build é€™å€‹å°ˆæ¡ˆã€‚ Dagger2 æœƒæ ¹æ“šé€™äº›è¨»è§£ä»¥åŠä»‹é¢ï¼Œç‚ºæˆ‘å€‘ç”¢ç”Ÿç›¸å°æ‡‰çš„ç¨‹å¼ç¢¼å¯¦ä½œã€‚</p>
<p>è®“æˆ‘å€‘è©¦è‘—åšä¸€å°å’–å•¡æ©Ÿï¼Œç”¨é€™å°å’–å•¡æ©Ÿåšä¸€æ¯å’–å•¡ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">val</span> coffeeProvider = DaggerCoffeeComponent.builder().build()</span><br><span class="line">    <span class="keyword">val</span> coffeeMaker = coffeeProvider.provideCoffeeMaker()</span><br><span class="line">    coffeeMaker.brew()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>DaggerCoffeeComponentæ˜¯ç¨‹å¼ç¢¼ç”¢ç”Ÿå™¨è‡ªå‹•ç”¢ç”Ÿçš„é¡åˆ¥ã€‚</p>
<p>åŸ·è¡Œçµæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~ ~ ~ heating ~ ~ ~</span><br><span class="line">=&gt; =&gt; pumping =&gt; =&gt;</span><br><span class="line"> [_]P coffee! [_]P</span><br></pre></td></tr></table></figure>
<h2 id="dagger2-in-android"><a class="header-anchor" href="#dagger2-in-android">Â¶</a>Dagger2 in Android</h2>
<p>å’–å•¡çš„æ•…äº‹çµæŸäº†ï¼Œæˆ‘å€‘æŠŠå ´æ™¯æ‹‰å› Android Appã€‚</p>
<p>ç”±æ–¼ Android ä¸­å¾ˆå¤šçµ„ä»¶çš„å¯¦é«”æ˜¯ç”± Android ç³»çµ±æŒæ§ï¼Œæˆ‘å€‘æ²’è¾¦æ³•è«‹å¦å¤–ä¸€å€‹æ¡†æ¶å¹«æˆ‘å€‘ç”¢ç”Ÿå·²ç¶“æ³¨å…¥å¥½çš„ Activity ä¸¦äº¤çµ¦ Android èª¿ç”¨ã€‚</p>
<p>å¾Œä¾†ï¼Œä»¥ä¸‹çš„è¿½åŠ å¥—ä»¶å°±å‡ºç¾äº†ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">...</span><br><span class="line">    implementation <span class="string">'com.google.dagger:dagger-android:2.17'</span></span><br><span class="line">    implementation <span class="string">'com.google.dagger:dagger-android-support:2.17'</span> <span class="comment">// if you use the support libraries</span></span><br><span class="line">    kapt <span class="string">'com.google.dagger:dagger-android-processor:2.17'</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€™é‚Šèˆ‰ä¸€å€‹æ —å­ã€‚ç°¡å–®çš„ Activity æ³¨å…¥ç¯„ä¾‹ (æˆ‘ä¹Ÿé‚„åœ¨å­¸ç¿’ä¸­ï¼Œä¹Ÿè¨±æ”¹å¤©æœƒæœ‰å€‹çºŒç¯‡å§â€¦æ”¹å¤©ğŸ˜¶)</p>
<p>ç¾åœ¨æœ‰ä¸€å€‹ Activity ï¼Œéœ€è¦ä¸€å€‹ ViewModelå·¥å» å¯¦é«”ã€‚å·¥å» æ˜¯ä»€éº¼æ±è¥¿å°±å…ˆä¸åœ¨æ­¤è¨è«–ã€‚</p>
<h3 id="inject-v2"><a class="header-anchor" href="#inject-v2">Â¶</a>Inject</h3>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> viewModelFactory: ViewModelFactory</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±æ–¼ Activity æ²’æœ‰å»ºæ§‹å­ï¼Œå› æ­¤åœ¨å‰µé€ æˆå“¡ç‰©ä»¶çš„æ™‚å€™æ³¨å…¥éœ€è¦çš„ç‰©ä»¶ã€‚</p>
<h3 id="module-v2"><a class="header-anchor" href="#module-v2">Â¶</a>Module</h3>
<p>è·Ÿå‰ä¸€ç« çš„æ–¹æ³•æ²’ä»€éº¼å¤ªå¤§çš„ä¸åŒï¼Œä½¿ç”¨ViewModelFactoryçš„å»ºæ§‹å­ä¾†å‰µé€ å¯¦é«”ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivityModule</span></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">provideViewModelFactory</span><span class="params">()</span></span> : ViewModelFactory&#123;</span><br><span class="line">        <span class="keyword">return</span> ViewModelFactory()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="component-v2"><a class="header-anchor" href="#component-v2">Â¶</a>Component</h3>
<p>é€™è£¡å¿…é ˆè¦åœ¨å®šç¾© modules æ™‚å¼•å…¥ dagger.android ä¸­çš„çµ„ä»¶ï¼Œ<code>AndroidInjectionModule</code> ï¼š</p>
<p>è€ŒåŸæœ¬è¼¸å‡ºå·²æ³¨å…¥å¯¦é«”çš„æ–¹æ³•è®Šæˆäº†éœ€è¦è¼¸å…¥ activity çš„æ–¹æ³•ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(modules = [</span></span><br><span class="line"><span class="meta">    MainActivityModule::class,</span></span><br><span class="line"><span class="meta">    AndroidInjectionModule::class</span></span><br><span class="line"><span class="meta">])</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">MainActivityComponent</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">inject</span><span class="params">(activity:<span class="type">MainActivity</span>)</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="run"><a class="header-anchor" href="#run">Â¶</a>Run</h3>
<p>è¨­å®šå®Œæˆï¼ŒæŒ‰ä¸‹ Build ä¹‹å¾Œç²å¾— Dagger2 å¹«æˆ‘å€‘ç”¢ç”Ÿçš„é¡åˆ¥ <code>DaggerMainActivityComponent</code> ï¼Œç”¨å®ƒåœ¨ activity çš„ç”Ÿå‘½é€±æœŸä¸­ <strong>è‡ªå·±æ³¨å…¥è‡ªå·±</strong> ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> viewModelFactory: ViewModelFactory</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// inject what you need</span></span><br><span class="line">        DaggerMainActivityComponent.builder().build().inject(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨é€™å€‹ç”Ÿå‘½é€±æœŸä¹‹å¾Œï¼Œæ¨™è¨» <code>@Inject</code> çš„ç‰©ä»¶å°±æœƒè¢«æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯èªªæœ‰å¯¦é«”å¯ä»¥ç”¨äº†ã€‚</p>
<h3 id="æ­£ç¢ºçš„æ³¨å…¥å§¿å‹¢"><a class="header-anchor" href="#æ­£ç¢ºçš„æ³¨å…¥å§¿å‹¢">Â¶</a>æ­£ç¢ºçš„æ³¨å…¥å§¿å‹¢</h3>
<p>ä»¥ä¸Šåƒ…æ˜¯åšå€‹ç°¡å–®çš„æ³¨å…¥è™•ç†ã€‚</p>
<p>å®˜æ–¹æä¾›çš„<a href="https://google.github.io/dagger/android" target="_blank" rel="noopener">æ•™å­¸</a>å°‡æ³¨å…¥ç«¯å»¶ä¼¸åˆ°äº† Application é¡åˆ¥ä¾†åˆå§‹åŒ–ã€‚<br>
æœ‰èˆˆè¶£çš„çœ‹å®˜å¯ä»¥åƒè€ƒçœ‹çœ‹ï¼Œçœ‹éä»¥ä¸Šçš„ä¾‹å­ï¼Œæ‡‰è©²æœƒæ¯”è¼ƒå®¹æ˜“çœ‹å¾—æ‡‚å®˜æ–¹çš„ä½œæ³•ã€‚</p>
<!-- # Dagger ä»¥å¤– -->
<h1 id="outro"><a class="header-anchor" href="#outro">Â¶</a>Outro</h1>
<p>å¯«é€™ç¯‡æ–‡èŠ±äº†å¿«ä¸€å€‹æ˜ŸæœŸçš„æ™‚é–“ï¼Œéç¨‹ä¸­ä¸€ç›´åœ¨æ‡·ç–‘æµç¨‹åˆ°åº•å°ä¸å°ï¼Œé€™äº›çš„ç¨‹å¼ç¢¼åˆ°åº•æœ‰æ²’æœ‰å¿…è¦ã€‚</p>
<p>ä¹Ÿè¨±ç¶“é©—ä¸è¶³å°±æ˜¯æœƒé€™å€‹æ¨£å­ã€‚</p>
<p>Dagger2 é‚„æœ‰å¾ˆå¤šå…¶ä»–çš„åŠŸèƒ½ï¼Œåƒæ˜¯å‚³éç”Ÿæˆå¯¦é«”æ‰€éœ€è¦çš„åƒæ•¸ã€å®š Scope ã€è¨­æˆå–®ä¾‹ã€ MultiBinds ã€blablaâ€¦ï¼Œä¹Ÿè¨±æ”¹å¤©æœƒæœ‰å€‹çºŒç¯‡â€¦æ”¹å¤©ğŸ˜¶</p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">st=>start: é–‹å§‹
e=>end: çµæŸ
op=>operation: åŠ ç†±å™¨æ‰“é–‹(Heater on)
op2=>operation: å¹«æµ¦æ‰“æ°´ç…®å’–å•¡(Pumping)
op3=>operation: å’–å•¡ç…®å¥½äº†
op4=>operation: åŠ ç†±å™¨é—œæ‰(Heater off)
cond=>condition: åŠ ç†±å™¨æ˜¯å¦æ‰“é–‹

st->op->cond->op2->op3->op4->e
cond(yes)->op2
cond(no)->op1</textarea><textarea id="flowchart-0-options" style="display: none">{"theme":"simple","scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script><textarea id="flowchart-1-code" style="display: none">op=>operation: å’–å•¡æ©Ÿ(Coffeemaker)
op2=>operation: å¹«æµ¦(Thermosiphon)
op3=>operation: åŠ ç†±å™¨(Electric Heater)

op->op2->op3</textarea><textarea id="flowchart-1-options" style="display: none">{"theme":"simple","scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-1-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-1-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-1", options);</script>
      </div>
        
          <section class="meta" id="footer-meta">
            <hr>
            <div class="new-meta-box">
              
                <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-05-16T10:33:04+08:00">
                  <a class="notlink">
                    <i class="fas fa-pencil-alt" aria-hidden="true"></i>
                    2019-05-16
                  </a>
                </div>
              
              
                
                <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Android-native/"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;Android native</a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Dagger2/"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;Dagger2</a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Dependency-injection/"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;Dependency injection</a></div>
              
              
            </div>
          </section>
        

        
            <div class="prev-next">
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>ä¸‹ä¸€é &nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/2019/05/13/gcpmljam1/" rel="prev" title="ML Study Jam1:ä½¿ç”¨ BigQueryMLé æ¸¬è¨ˆç¨‹è»Šè²»ç‡">
                                    
                                        ML Study Jam1:ä½¿ç”¨ BigQueryMLé æ¸¬è¨ˆç¨‹è»Šè²»ç‡
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/Google-Could-Platform/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Google Could Platform</a> <a class="tag" href="/tags/SQL/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>SQL</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        

    </section>

</article>

<!-- æ ¹æ®é¡µé¢mathjaxå˜é‡å†³å®šæ˜¯å¦åŠ è½½MathJaxæ•°å­¦å…¬å¼js -->


<br>

<!-- æ˜¾ç¤ºæ¨èæ–‡ç« å’Œè¯„è®º -->



  <article class="post white-box comments">
    <section class="article typo">
      
      
        <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;è©•è«–</h4>
        
          <section id="comments">
            <div id="disqus_thread">
              âš ï¸  ç„¡æ³•åŠ è¼‰è©•è«–ç³»çµ±ï¼Œè«‹ç¢ºä¿æ‚¨çš„ç¶²çµ¡èƒ½å¤ æ­£å¸¸è¨ªå• <a href="https://disqus.com">Disqus</a> ã€‚
            </div>
          </section>
        
        
        
      
    </section>
  </article>



<script>
    window.subData = {
        title: 'å’–å•¡çš„æ•…äº‹ï¼š ä¾è³´æ³¨å…¥ã€Daggerã€Android',
        tools: true
    }
</script>


        </div>
        <aside class='l_side'>
            
  
  
    
      
      
        <section class="author">
  <div class="content pure">
    
      <div class="avatar">
        <img class="avatar" src="/images/Dora.jpg">
      </div>
    
    
      <div class="text">
        
          <h2>è²“åœˆéƒ¨è½</h2>
        
        
          <p>å¯«å€‹ç­†è¨˜çµ¦è‡ªå·±çœ‹<br>
ä½ ä¹Ÿå¯ä»¥é †ä¾¿çœ‹çœ‹</p>

        
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="https://github.com/DarKArieS" class="social flat-btn" target="_blank" rel="external"><i class="social fab fa-github" aria-hidden="true"></i></a>
          
        
      </div>
    
  </div>
</section>

      
    
  
    
      
      
        
  <section class="category">
    
<header class="pure">
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;æ‰€æœ‰åˆ†é¡</div>
  
</header>

    <div class="content pure">
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/Android-Note/" href="/categories/Android-Note/"><div class="name">Android Note</div><div class="badge">(4)</div></a></li>
        
          <li><a class="flat-box" title="/categories/C/" href="/categories/C/"><div class="name">C++</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Design-pattern/" href="/categories/Design-pattern/"><div class="name">Design pattern</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Google-Could-Platform/" href="/categories/Google-Could-Platform/"><div class="name">Google Could Platform</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Hexo/" href="/categories/Hexo/"><div class="name">Hexo</div><div class="badge">(2)</div></a></li>
        
      </ul>
    </div>
  </section>


      
    
  
    
      
      
        
  <section class="toc-wrapper">
    
<header class="pure">
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;æ–‡ç« ç›®éŒ„</div>
  
    <div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class="content pure">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#dependency-ä¾è³´çš„æ•…äº‹"><span class="toc-text">Â¶Dependency ä¾è³´çš„æ•…äº‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åšä¸€å°å’–å•¡æ©Ÿ"><span class="toc-text">Â¶åšä¸€å°å’–å•¡æ©Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¾è³´é—œä¿‚"><span class="toc-text">Â¶ä¾è³´é—œä¿‚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è§£é–‹ä¾è³´-decouple-ä¾è³´æ³¨å…¥"><span class="toc-text">Â¶è§£é–‹ä¾è³´ (Decouple) - ä¾è³´æ³¨å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¾è³´åè½‰"><span class="toc-text">Â¶ä¾è³´åè½‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é™ä½æˆæœ¬-æé«˜å®‰å…¨-èª¤"><span class="toc-text">Â¶é™ä½æˆæœ¬ã€æé«˜å®‰å…¨ (èª¤)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dagger-ä¾è³´æ³¨å…¥æ¡†æ¶"><span class="toc-text">Â¶Dagger ä¾è³´æ³¨å…¥æ¡†æ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#é‚„æ˜¯å’–å•¡æ©Ÿçš„æ•…äº‹"><span class="toc-text">Â¶é‚„æ˜¯å’–å•¡æ©Ÿçš„æ•…äº‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#inject"><span class="toc-text">Â¶Inject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#module"><span class="toc-text">Â¶Module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#component"><span class="toc-text">Â¶Component</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åšå’–å•¡å›‰"><span class="toc-text">Â¶åšå’–å•¡å›‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dagger2-in-android"><span class="toc-text">Â¶Dagger2 in Android</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#inject-v2"><span class="toc-text">Â¶Inject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#module-v2"><span class="toc-text">Â¶Module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#component-v2"><span class="toc-text">Â¶Component</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run"><span class="toc-text">Â¶Run</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ­£ç¢ºçš„æ³¨å…¥å§¿å‹¢"><span class="toc-text">Â¶æ­£ç¢ºçš„æ³¨å…¥å§¿å‹¢</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#outro"><span class="toc-text">Â¶Outro</span></a></li></ol>
    </div>
  </section>


      
    
  


        </aside>
        <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
    </div>
    <footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="https://github.com/DarKArieS" class="social fab fa-github flat-btn" target="_blank" rel="external"></a>
        
      
    </div>
  
  <br>
  <div><p>åšå®¢å…§å®¹éµå¾ª <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh_TW">å§“åæ¨™ç¤º-éå•†æ¥­æ€§-ç›¸åŒæ–¹å¼åˆ†äº« 4.0 åœ‹éš› (CC BY-NC-SA 4.0) å”è­°</a></p>
</div>
  <div>æœ¬ç«™ä½¿ç”¨ <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a> ä½œç‚ºä¸»é¡Œï¼Œç¸½è¨ªå•é‡ç‚º <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> æ¬¡ã€‚
  </div>
</footer>

    <script>setLoadingBarProgress(80);</script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>


  
    <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
    <script type="text/javascript">
      $(function() {
        const $reveal = $('.reveal');
    		if ($reveal.length === 0) return;
    		const sr = ScrollReveal({ distance: 0 });
    		sr.reveal('.reveal');
      });
    </script>
  
  
    <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
    <script type="text/javascript">
      $(function() {
        Waves.attach('.flat-btn', ['waves-button']);
        Waves.attach('.float-btn', ['waves-button', 'waves-float']);
        Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
        Waves.attach('.flat-box', ['waves-block']);
        Waves.attach('.float-box', ['waves-block', 'waves-float']);
        Waves.attach('.waves-image');
        Waves.init();
      });
    </script>
  
  
    <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>
  
  
    <!-- fastclick -->
    <script src="https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body)
      }, false)
    </script>
  
  

  
  
    
      
        <script>
          var disqus_shortname = 'nekorings-blog';
          
            var disqus_url = 'http://yoursite.com/2019/05/15/androidDI/';
          
          (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      
      
      
    
  
  
    <script src="/js/app.js"></script>
<script src="/js/search.js"></script>
  






    <script>setLoadingBarProgress(100);</script>
</body>
</html>
